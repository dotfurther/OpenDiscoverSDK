<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>How to use the IDocumentContentExtractor Interface</title><meta name="Title" content="How to use the IDocumentContentExtractor Interface" /><meta name="Microsoft.Help.Id" content="8e0c8470-7ad9-4dae-95fb-7a9eb05b78f1" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="System.Keywords" content="IDocumentContentExtractor" /><meta name="System.Keywords" content="extract content from documents and emails" /><meta name="System.Keywords" content="Word" /><meta name="System.Keywords" content="Excel" /><meta name="System.Keywords" content="PowerPoint" /><meta name="System.Keywords" content="Outlook .msg" /><meta name="System.Keywords" content=".msg" /><meta name="System.Keywords" content=".pdf" /><meta name="System.Keywords" content=".doc" /><meta name="System.Keywords" content=".docx" /><meta name="System.Keywords" content=".xls" /><meta name="System.Keywords" content=".xlsx" /><meta name="System.Keywords" content=".ppt" /><meta name="System.Keywords" content=".pptx" /><meta name="System.Keywords" content=".eml" /><meta name="System.Keywords" content="PDF" /><meta name="System.Keywords" content=".pdf" /><meta name="System.Keywords" content="email" /><meta name="System.Keywords" content="How to use the IDocumentContentExtractor Interface" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Description" content="The section shows how to use the IDocumentContentExtractor interface. This interface is used to extract content from office documents, emails, PDFs, HTML files, raster images, multimedia files, and vector images." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Open Discover® SDK and Platform for .NET - Release 2025.4.6<form id="SearchForm" method="get" action="#" onsubmit="TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/3ce0f09f-461e-4081-8568-1666ea124b73.htm" title="Open Discover® SDK and Platform for .NET - Release 2025.4.6" tocid="roottoc">Open Discover® SDK and Platform for .NET - Release 2025.4.6</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/59ed8473-fbd9-4bf1-9e80-33226882e71f.htm" title="How To" tocid="59ed8473-fbd9-4bf1-9e80-33226882e71f">How To</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/71d4234a-21a7-48a5-9d83-d1b8a2ed4250.htm" title="Extract Content using the SDK ContentExtractorFactory" tocid="71d4234a-21a7-48a5-9d83-d1b8a2ed4250">Extract Content using the SDK ContentExtractorFactory</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/8e0c8470-7ad9-4dae-95fb-7a9eb05b78f1.htm" title="How to use the IDocumentContentExtractor Interface" tocid="8e0c8470-7ad9-4dae-95fb-7a9eb05b78f1">How to use the IDocumentContentExtractor Interface</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/065d43df-6ccd-4692-a2b2-0f114a52848b.htm" title="How to use the IArchiveExtractor Interface" tocid="065d43df-6ccd-4692-a2b2-0f114a52848b">How to use the IArchiveExtractor Interface</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/6d85e229-353b-4ec3-8ede-5710273d1cf5.htm" title="How to use the IMailStoreExtractor Interface" tocid="6d85e229-353b-4ec3-8ede-5710273d1cf5">How to use the IMailStoreExtractor Interface</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/91048e30-0b6e-476f-986d-f5f56b7a5525.htm" title="How to use the IDatabaseExtractor Interface" tocid="91048e30-0b6e-476f-986d-f5f56b7a5525">How to use the IDatabaseExtractor Interface</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/a2cbea0a-2486-40fb-8c08-2db0b8f5ee27.htm" title="How to use the IDocumentStoreExtractor Interface" tocid="a2cbea0a-2486-40fb-8c08-2db0b8f5ee27">How to use the IDocumentStoreExtractor Interface</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/e0906c8e-d500-4c1f-af0c-7ea7e407b53e.htm" title="How to use the IUnsupportedExtractor Interface" tocid="e0906c8e-d500-4c1f-af0c-7ea7e407b53e">How to use the IUnsupportedExtractor Interface</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/113aee0b-e0dd-4667-91de-3f82c0c96636.htm" title="How to use the ILargeUnsupportedExtractor Interface" tocid="113aee0b-e0dd-4667-91de-3f82c0c96636">How to use the ILargeUnsupportedExtractor Interface</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/b789bdbc-1f4a-4642-93da-86e218036e8f.htm" title="How to use the ILargeEncodedTextExtractor Interface" tocid="b789bdbc-1f4a-4642-93da-86e218036e8f">How to use the ILargeEncodedTextExtractor Interface</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>How to use the IDocumentContentExtractor Interface</h1></td></tr></table><div><p>
      The section shows how to use the IDocumentContentExtractor interface. This interface is used to extract content from office documents, emails, PDFs, HTML files,
      raster images, multimedia files, and vector images.
      The section also shows how to decrypt file formats that are supported for decryption through example.
      </p></div><div id="IDBABSection" class="collapsibleSection"><p>
        The <a href="fc555ced-4e25-4a75-d7eb-c52c1ad0fd37.htm">IDocumentContentExtractor</a> interface has one method used to extract 
        document content:   <span class="code">DocumentContent ExtractContent(string password = null)</span></p><p>
        The password is optional and is used to decrypt supported types for decryption such as Microsoft Word, Excel, PowerPoint, PDF, and OpenDocument formats. 
        </p><p>
        The following example shows how to use IDocumentContentExtractor interface to extract content from a password encrypted document by prompting 
        the user to enter a password via a dialog box. Optionally, if user knows the passwords of the documents they are going to process the user can set
        up a password list to cycle through instead of prompting via a dialog box.
        </p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" />  Note</th></tr><tr><td><p>
          Attempting to decrypt a document with a password is an expensive operation by design. This SDK is not optimized to be a password cracker and should not be used as one. 
          Any password lists to cycle through when encountering documents should only contain known passwords that decrypt the password encrypted documents being processed.
          </p></td></tr></table></div><div id="IDEABAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDEABAB_tab1" class="codeSnippetContainerTabSingle">IDocumentContentExtractor Interface Usage</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDEABAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDEABAB');return false;" title="Copy">Copy</a></div></div><div id="IDEABAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-lineno">  1</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span><span class="highlight-keyword">var</span> settings = <span class="highlight-keyword">new</span> ContentExtractionSettings();
<span class="highlight-lineno">  2</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>settings.CalculateBinaryHash        = <span class="highlight-keyword">true</span>; <span class="highlight-comment">// Calculate binary hashes</span>
<span class="highlight-lineno">  3</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>settings.CalculateContentHash       = <span class="highlight-keyword">true</span>; <span class="highlight-comment">// Calculate content hashes on supported formats such as emails and Office documents</span>
<span class="highlight-lineno">  4</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>settings.ExtractEmbeddedDocuments   = <span class="highlight-keyword">true</span>; <span class="highlight-comment">// Extract attachments\embedded documents</span>
<span class="highlight-lineno">  5</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>settings.ExtractOfficeEmbeddedMedia = <span class="highlight-keyword">true</span>; <span class="highlight-comment">// Extract embedded media for Office formats</span>
<span class="highlight-lineno">  6</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>settings.ExtractionType             = ContentExtractionType.TextAndMetadata; <span class="highlight-comment">// We want text and metadata extracted</span>
<span class="highlight-lineno">  7</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">  8</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span><span class="highlight-keyword">using</span> (<span class="highlight-keyword">var</span> stream = File.OpenRead(filePath))
<span class="highlight-lineno">  9</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>{
<span class="highlight-lineno"> 10</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-comment">//========================================================================================</span>
<span class="highlight-lineno"> 11</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-comment">// Step 1 - Identify document file format:</span>
<span class="highlight-lineno"> 12</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-comment">//========================================================================================</span>
<span class="highlight-lineno"> 13</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-keyword">var</span> docIdResult = DocumentIdentifier.Identify(stream, filePath);
<span class="highlight-lineno"> 14</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 15</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-comment">//========================================================================================</span>
<span class="highlight-lineno"> 16</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-comment">// Step 2 - Get the content extractor result for the file format:</span>
<span class="highlight-lineno"> 17</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-comment">//========================================================================================</span>
<span class="highlight-lineno"> 18</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-keyword">var</span> contentExtractorResult = ContentExtractorFactory.GetContentExtractor(stream, docIdResult, filePath, settings);
<span class="highlight-lineno"> 19</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 20</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-keyword">if</span> (contentExtractorResult.HasError)
<span class="highlight-lineno"> 21</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    {
<span class="highlight-lineno"> 22</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        LogErrorMessage(<span class="highlight-keyword">string</span>.Format(<span class="highlight-literal">"Error getting content extractor for file ID {0}: {1}"</span>, docIdResult.ID, contentExtractorResult.Error));
<span class="highlight-lineno"> 23</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    }
<span class="highlight-lineno"> 24</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-keyword">else</span>
<span class="highlight-lineno"> 25</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    {
<span class="highlight-lineno"> 26</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">//========================================================================================</span>
<span class="highlight-lineno"> 27</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// Step 3 - Get the specific IContentExtractor derived interface for the file format:</span>
<span class="highlight-lineno"> 28</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">//========================================================================================</span>
<span class="highlight-lineno"> 29</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-keyword">var</span> extractorType = contentExtractorResult.ContentExtractor.ContentExtractorType;
<span class="highlight-lineno"> 30</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 31</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-keyword">switch</span> (extractorType)
<span class="highlight-lineno"> 32</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        {
<span class="highlight-lineno"> 33</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>              <span class="highlight-keyword">case</span> ContentExtractorType.Document:
<span class="highlight-lineno"> 34</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                  {
<span class="highlight-lineno"> 35</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// The "ContentExtractorType.Document" extractor type indicates the IDocumentContentExtractor interface is to be used</span>
<span class="highlight-lineno"> 36</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> docExtractor = ((IDocumentContentExtractor)contentExtractorResult.ContentExtractor);
<span class="highlight-lineno"> 37</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> docContent   = docExtractor.ExtractContent();
<span class="highlight-lineno"> 38</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 39</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// Password cycling for supported encrypted documents: </span>
<span class="highlight-lineno"> 40</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">//  - DocumentContent.Result = ContentResult.WrongPassword, indicating wrong password, because on 1st call to ExtractContent</span>
<span class="highlight-lineno"> 41</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">//    method above we passed in null (default value) and this document is encrypted</span>
<span class="highlight-lineno"> 42</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">//  - User can also set up a password list of known passwords to cycle through when encountering encrypted documents.</span>
<span class="highlight-lineno"> 43</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">//  - Check if "docExtractor.SupportsDecryption" is true, if true then this format supports decryption</span>
<span class="highlight-lineno"> 44</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">if</span> (docContent.Result == ContentResult.WrongPassword &amp;&amp; docContent.IsEncrypted &amp;&amp; docExtractor.SupportsDecryption)
<span class="highlight-lineno"> 45</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    {
<span class="highlight-lineno"> 46</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        RETRY_DOC_PASSWORD:;
<span class="highlight-lineno"> 47</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 48</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-keyword">var</span> passwordDialog = <span class="highlight-keyword">new</span> PasswordForm();
<span class="highlight-lineno"> 49</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 50</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-keyword">if</span> (passwordDialog.ShowDialog() == DialogResult.OK)
<span class="highlight-lineno"> 51</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        {
<span class="highlight-lineno"> 52</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                            <span class="highlight-comment">// Try the user entered password:</span>
<span class="highlight-lineno"> 53</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                            docContent = ((IDocumentContentExtractor)contentExtractorResult.ContentExtractor).ExtractContent(passwordDialog.Password);
<span class="highlight-lineno"> 54</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 55</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                            <span class="highlight-keyword">if</span> (docContent.Result == ContentResult.WrongPassword)
<span class="highlight-lineno"> 56</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                            {
<span class="highlight-lineno"> 57</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                                <span class="highlight-keyword">goto</span> RETRY_DOC_PASSWORD;
<span class="highlight-lineno"> 58</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                            }
<span class="highlight-lineno"> 59</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        }
<span class="highlight-lineno"> 60</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    }
<span class="highlight-lineno"> 61</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 62</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">if</span> (docContent.Result == ContentResult.Ok)
<span class="highlight-lineno"> 63</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    {       
<span class="highlight-lineno"> 64</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-comment">// Success - Do something with extracted content, for example use Lucene.NET to index the text and index the metadata as fields</span>
<span class="highlight-lineno"> 65</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 66</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-comment">// </span>
<span class="highlight-lineno"> 67</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-comment">// Check for special document content classes that derive from DocumentContent class and</span>
<span class="highlight-lineno"> 68</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-comment">// have extra content extracted:</span>
<span class="highlight-lineno"> 69</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-comment">// </span>
<span class="highlight-lineno"> 70</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-keyword">if</span> (docContent <span class="highlight-keyword">is</span> EmailDocumentContent)
<span class="highlight-lineno"> 71</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        {
<span class="highlight-lineno"> 72</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                           <span class="highlight-keyword">var</span> emailDocContent = (EmailDocumentContent)docContent;
<span class="highlight-lineno"> 73</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                           <span class="highlight-comment">// Do something we extra email related content...</span>
<span class="highlight-lineno"> 74</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        }
<span class="highlight-lineno"> 75</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-keyword">else</span> <span class="highlight-keyword">if</span> (docContent <span class="highlight-keyword">is</span> HtmlDocumentContent)
<span class="highlight-lineno"> 76</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        {
<span class="highlight-lineno"> 77</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                           <span class="highlight-keyword">var</span> htmlDocContent = (HtmlDocumentContent)docContent;
<span class="highlight-lineno"> 78</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                           <span class="highlight-comment">// Do something we extra HTML related content... the extra HTML related content such as HyperLinks property</span>
<span class="highlight-lineno"> 79</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                           <span class="highlight-comment">// can be used for web-crawling a website</span>
<span class="highlight-lineno"> 80</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        }
<span class="highlight-lineno"> 81</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        <span class="highlight-keyword">else</span> <span class="highlight-keyword">if</span> (docContent <span class="highlight-keyword">is</span> PdfDocumentContent)
<span class="highlight-lineno"> 82</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        {
<span class="highlight-lineno"> 83</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                           <span class="highlight-keyword">var</span> pdfDocContent = (PdfDocumentContent)docContent;
<span class="highlight-lineno"> 84</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                           <span class="highlight-comment">// Do something we extra PDF related content...</span>
<span class="highlight-lineno"> 85</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                        }                                    
<span class="highlight-lineno"> 86</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    }
<span class="highlight-lineno"> 87</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">else</span>
<span class="highlight-lineno"> 88</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    {
<span class="highlight-lineno"> 89</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                       <span class="highlight-comment">// Some level of Error - Documents that have an error often times still have some content extracted such as metadata, </span>
<span class="highlight-lineno"> 90</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                       <span class="highlight-comment">// attachments, or text (there are fallback text extraction procedures for some formats and/or binary-text filtering </span>
<span class="highlight-lineno"> 91</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                       <span class="highlight-comment">// can be used to extract useful text in a lot of cases)</span>
<span class="highlight-lineno"> 92</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    }
<span class="highlight-lineno"> 93</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                }
<span class="highlight-lineno"> 94</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                <span class="highlight-keyword">break</span>;
<span class="highlight-lineno"> 95</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno"> 96</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>            <span class="highlight-keyword">case</span> ContentExtractorType.Archive:
<span class="highlight-lineno"> 97</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                {
<span class="highlight-lineno"> 98</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> archiveExtractor = ((IArchiveExtractor)contentExtractorResult.ContentExtractor);
<span class="highlight-lineno"> 99</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// TODO: A different help topic will show how to use this interface</span>
<span class="highlight-lineno">100</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                }
<span class="highlight-lineno">101</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                <span class="highlight-keyword">break</span>;
<span class="highlight-lineno">102</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>            <span class="highlight-keyword">case</span> ContentExtractorType.MailStore:
<span class="highlight-lineno">103</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                {
<span class="highlight-lineno">104</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> mailStoreExtractor = ((IMailStoreExtractor)contentExtractorResult.ContentExtractor);
<span class="highlight-lineno">105</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// TODO: A different help topic will show how to use this interface</span>
<span class="highlight-lineno">106</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                }
<span class="highlight-lineno">107</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                <span class="highlight-keyword">break</span>;
<span class="highlight-lineno">108</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>            <span class="highlight-keyword">case</span> ContentExtractorType.Database:
<span class="highlight-lineno">109</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                {
<span class="highlight-lineno">110</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> databaseExtractor = ((IDatabaseExtractor)contentExtractorResult.ContentExtractor);
<span class="highlight-lineno">111</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// TODO: A different help topic will show how to use this interface</span>
<span class="highlight-lineno">112</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                }
<span class="highlight-lineno">113</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                <span class="highlight-keyword">break</span>;                            
<span class="highlight-lineno">114</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>            <span class="highlight-keyword">case</span> ContentExtractorType.DocumentStore:
<span class="highlight-lineno">115</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                {
<span class="highlight-lineno">116</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> docStoreExtractor = ((IDocumentContentExtractor)contentExtractorResult.ContentExtractor);
<span class="highlight-lineno">117</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// TODO: A different help topic will show how to use this interface</span>
<span class="highlight-lineno">118</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                }
<span class="highlight-lineno">119</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                <span class="highlight-keyword">break</span>;
<span class="highlight-lineno">120</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>            <span class="highlight-keyword">case</span> ContentExtractorType.Unsupported:
<span class="highlight-lineno">121</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                {
<span class="highlight-lineno">122</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> bin2TextExtractor = ((IUnsupportedExtractor)contentExtractorResult.ContentExtractor);
<span class="highlight-lineno">123</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// TODO: A different help topic will show how to use this interface</span>
<span class="highlight-lineno">124</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                }
<span class="highlight-lineno">125</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                <span class="highlight-keyword">break</span>;
<span class="highlight-lineno">126</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>            <span class="highlight-keyword">case</span> ContentExtractorType.LargeUnsupported:
<span class="highlight-lineno">127</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                {
<span class="highlight-lineno">128</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> largeDocBin2TextExtractor = ((ILargeUnsupportedExtractor)contentExtractorResult.ContentExtractor);
<span class="highlight-lineno">129</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// TODO: A different help topic will show how to use this interface</span>
<span class="highlight-lineno">130</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                }
<span class="highlight-lineno">131</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                <span class="highlight-keyword">break</span>;
<span class="highlight-lineno">132</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>            <span class="highlight-keyword">case</span> ContentExtractorType.LargeEncodedText:
<span class="highlight-lineno">133</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                {
<span class="highlight-lineno">134</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-keyword">var</span> largeEncodedTextExtractor = ((ILargeEncodedTextExtractor)contentExtractorResult.ContentExtractor);
<span class="highlight-lineno">135</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                    <span class="highlight-comment">// TODO: A different help topic will show how to use this interface</span>
<span class="highlight-lineno">136</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                }
<span class="highlight-lineno">137</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>                <span class="highlight-keyword">break</span>;
<span class="highlight-lineno">138</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        }
<span class="highlight-lineno">139</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    }
<span class="highlight-lineno">140</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>}</pre></div></div></div><p>
        The following unit test example code illustrates the various document content extracted like text, metadata, attachments, hashes, and languages identified in the 
        extracted text:
        </p><div id="IDGABAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDGABAB_tab1" class="codeSnippetContainerTabSingle">Email Document</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDGABAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDGABAB');return false;" title="Copy">Copy</a></div></div><div id="IDGABAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-lineno"> 1</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>[TestMethod]
<span class="highlight-lineno"> 2</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> OutlookMsgTextAndMetadataTest()
<span class="highlight-lineno"> 3</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>{
<span class="highlight-lineno"> 4</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-keyword">var</span> settings = <span class="highlight-keyword">new</span> ContentExtractionSettings();
<span class="highlight-lineno"> 5</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    settings.CalculateBinaryHash        = <span class="highlight-keyword">true</span>;
<span class="highlight-lineno"> 6</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    settings.CalculateContentHash       = <span class="highlight-keyword">true</span>;
<span class="highlight-lineno"> 7</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    settings.ShowUtcOffsetForTimeText   = <span class="highlight-keyword">true</span>;
<span class="highlight-lineno"> 8</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    settings.ExtractEmbeddedDocuments   = <span class="highlight-keyword">false</span>;
<span class="highlight-lineno"> 9</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    settings.ExtractOfficeEmbeddedMedia = <span class="highlight-keyword">false</span>;
<span class="highlight-lineno">10</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    settings.CollectionTimeZone = TimeZoneInfo.Utc;
<span class="highlight-lineno">11</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    settings.ExtractionType     = ContentExtractionType.TextAndMetadata;
<span class="highlight-lineno">12</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">13</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-keyword">var</span> file        = Path.Combine(_testFilesBasePath, <span class="highlight-literal">@"Deduplication\Email"</span>, <span class="highlight-literal">"test.msg"</span>);
<span class="highlight-lineno">14</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-keyword">var</span> sentDateUtc = <span class="highlight-keyword">new</span> DateTime(<span class="highlight-number">2007</span>, <span class="highlight-number">1</span>, <span class="highlight-number">5</span>, <span class="highlight-number">0</span>, <span class="highlight-number">16</span>, <span class="highlight-number">11</span>, DateTimeKind.Utc);
<span class="highlight-lineno">15</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">16</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    <span class="highlight-keyword">using</span> (<span class="highlight-keyword">var</span> stream = File.OpenRead(file))
<span class="highlight-lineno">17</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    {
<span class="highlight-lineno">18</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-keyword">var</span> idResult        = DocumentIdentifier.Identify(stream, file);
<span class="highlight-lineno">19</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-keyword">var</span> extractorResult = ContentExtractorFactory.GetContentExtractor(stream, idResult, file, settings);
<span class="highlight-lineno">20</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">21</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-keyword">var</span> extractorType = extractorResult.ContentExtractor.ContentExtractorType;
<span class="highlight-lineno">22</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(extractorType == ContentExtractorType.Document);
<span class="highlight-lineno">23</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">24</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-keyword">var</span> docExtractor = ((IDocumentContentExtractor)extractorResult.ContentExtractor);
<span class="highlight-lineno">25</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-keyword">var</span> docContent   = docExtractor.ExtractContent();
<span class="highlight-lineno">26</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">27</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// Assert that the DocumentContent object is an email type and is safe to type-cast to EmailDocumentContent:</span>
<span class="highlight-lineno">28</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(docContent.IsEmailType);
<span class="highlight-lineno">29</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-keyword">var</span> emailContent = docContent <span class="highlight-keyword">as</span> EmailDocumentContent;
<span class="highlight-lineno">30</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">31</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Result == ContentResult.Ok);
<span class="highlight-lineno">32</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">33</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.FormatId.ID == Id.OutlookMessage);
<span class="highlight-lineno">34</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.ExtractedText.StartsWith(<span class="highlight-literal">"From: dummy &lt;dummy@fake.org&gt;"</span>));
<span class="highlight-lineno">35</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.ExtractedText.IndexOf(<span class="highlight-literal">"Subject: RE: Party"</span>) &gt; <span class="highlight-number">0</span>);
<span class="highlight-lineno">36</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.ExtractedText.IndexOf(<span class="highlight-literal">"Are you going to the party?"</span>) &gt; <span class="highlight-number">0</span>);
<span class="highlight-lineno">37</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">38</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.ChildDocuments.Count   == <span class="highlight-number">1</span>);
<span class="highlight-lineno">39</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.ChildDocuments[<span class="highlight-number">0</span>].Name == <span class="highlight-literal">"directions.doc"</span>);
<span class="highlight-lineno">40</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">41</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.MD5BinaryHash      == <span class="highlight-literal">"471B0C2443F2B2E610B6BF905480DEF5"</span>);
<span class="highlight-lineno">42</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.SHA1BinaryHash     == <span class="highlight-literal">"86EF0955E35A6BDBF003BE813FBF0395B6D7546F"</span>);
<span class="highlight-lineno">43</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// Email types support content hash, the content hash aides in de-duplicating the same email whether they are saved </span>
<span class="highlight-lineno">44</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// as .msg, .eml, or .emlx formats. If you save an .eml message as an .msg using Outlook, these 2 files will have</span>
<span class="highlight-lineno">45</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// different binary hashes due to different bytes in files. However, the content hash most likely will be the same</span>
<span class="highlight-lineno">46</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// for both files.</span>
<span class="highlight-lineno">47</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.MD5ContentHash     == <span class="highlight-literal">"2F780AEA9DD7930439B340FFBC660A53"</span>);
<span class="highlight-lineno">48</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.SHA1ContentHash    == <span class="highlight-literal">"EE6B61C9BAEBC87D6F5D2CB33B65EEA9B0F5C3E2"</span>);
<span class="highlight-lineno">49</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// Email types have extra hashes calculated:</span>
<span class="highlight-lineno">50</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sha1HeaderHash     == <span class="highlight-literal">"806A056F8F7BAD3FAE31A226B26EE1E3653AF423"</span>);
<span class="highlight-lineno">51</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sha1BodyHash       == <span class="highlight-literal">"6F38C846E0E468732FBCA8CCB9EDDE131A1501A6"</span>);
<span class="highlight-lineno">52</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sha1RecipientsHash == <span class="highlight-literal">"D8FE882FC2E8AE88D0504D58BBF324C7677BCD8B"</span>);
<span class="highlight-lineno">53</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">54</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Subject == <span class="highlight-literal">"RE: Party"</span>);
<span class="highlight-lineno">55</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">56</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sender != <span class="highlight-keyword">null</span>);
<span class="highlight-lineno">57</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sender.Name        == <span class="highlight-literal">"dummy"</span>);
<span class="highlight-lineno">58</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sender.AddressType == EmailAddressType.Sender);
<span class="highlight-lineno">59</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sender.SmtpAddress == <span class="highlight-literal">"dummy@fake.org"</span>);
<span class="highlight-lineno">60</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sender.X500DN      == <span class="highlight-keyword">string</span>.Empty);
<span class="highlight-lineno">61</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">62</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.From        != <span class="highlight-keyword">null</span>);
<span class="highlight-lineno">63</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.From.Count  == <span class="highlight-number">1</span>);
<span class="highlight-lineno">64</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sender.Name == emailContent.From[<span class="highlight-number">0</span>].Name);
<span class="highlight-lineno">65</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.From[<span class="highlight-number">0</span>].AddressType == EmailAddressType.From);
<span class="highlight-lineno">66</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Sender.SmtpAddress  == emailContent.From[<span class="highlight-number">0</span>].SmtpAddress);
<span class="highlight-lineno">67</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.From[<span class="highlight-number">0</span>].X500DN      == <span class="highlight-keyword">null</span>);
<span class="highlight-lineno">68</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.SentDate.Value.CompareTo(sentDateUtc) == <span class="highlight-number">0</span>);
<span class="highlight-lineno">69</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">70</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.HasHtmlBody);
<span class="highlight-lineno">71</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.HasTextBody);
<span class="highlight-lineno">72</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.HasRtfBody);
<span class="highlight-lineno">73</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.BodyType  == EmailBodyType.RtfEncapsulatedHTML); <span class="highlight-comment">// HTML body originated from RTF body(was encapsulated in RTF body)</span>
<span class="highlight-lineno">74</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.MessageId == <span class="highlight-literal">"&lt;1234567892423424242.fake.org&gt;"</span>);
<span class="highlight-lineno">75</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">76</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// Extracted text language identification results:</span>
<span class="highlight-lineno">77</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.LanguageIdResults != <span class="highlight-keyword">null</span>);
<span class="highlight-lineno">78</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.LanguageIdResults.Count == <span class="highlight-number">1</span>);
<span class="highlight-lineno">79</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.LanguageIdResults[<span class="highlight-number">0</span>].LangIso639 == <span class="highlight-literal">"en"</span>); <span class="highlight-comment">// English</span>
<span class="highlight-lineno">80</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">81</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(emailContent.Metadata.Count == <span class="highlight-number">34</span>); <span class="highlight-comment">// 34 email metadata fields extracted in total</span>
<span class="highlight-lineno">82</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>
<span class="highlight-lineno">83</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// We use "known" string and datetime metadata helper classes for the metadata field names (in this test it is known that these fields exist </span>
<span class="highlight-lineno">84</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        <span class="highlight-comment">// in the test file):</span>
<span class="highlight-lineno">85</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(((StringProperty)emailContent.Metadata[KnownStringMetadataFields.From]).Value       == <span class="highlight-literal">"dummy &lt;dummy@fake.org&gt;"</span>);
<span class="highlight-lineno">86</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(((StringProperty)emailContent.Metadata[KnownStringMetadataFields.SenderName]).Value == <span class="highlight-literal">"dummy"</span>);
<span class="highlight-lineno">87</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(((StringProperty)emailContent.Metadata[KnownStringMetadataFields.SentRepresentingName]).Value == <span class="highlight-literal">"dummy"</span>);
<span class="highlight-lineno">88</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(((StringProperty)emailContent.Metadata[KnownStringMetadataFields.SenderSmtpAddress]).Value    == <span class="highlight-literal">"dummy@fake.org"</span>);
<span class="highlight-lineno">89</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(((StringProperty)emailContent.Metadata[KnownStringMetadataFields.To]).Value                   == <span class="highlight-literal">"&lt;friendOfdummy@fake.org&gt;"</span>);
<span class="highlight-lineno">90</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>        Assert.IsTrue(((DateTimeProperty)emailContent.Metadata[KnownDateTimeMetadataFields.SentDate]).Value.CompareTo(sentDateUtc) == <span class="highlight-number">0</span>);
<span class="highlight-lineno">91</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>    }
<span class="highlight-lineno">92</span><span class="highlight-lnborder"></span><span class="highlight-spacerShort"></span>}</pre></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Other Resources</h4><div><a href="https://github.com/dotfurther/OpenDiscoverSDK" target="_blank" rel="noopener noreferrer">OpenDiscoverSDK Samples Repository on GitHub</a></div></div></div></div><div id="PageFooter" class="pageFooter"><p>Copyright © 2017-2025 dotFurther, inc. All rights reserved.  "Open Discover" is a registered trademark (®) of dotFurther, inc.</p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support%40dotfurther.com?Subject=Open%20Discover®%20SDK%20and%20Platform%20for%20.NET%20-%20Release%202025.4.6">support@dotfurther.com</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>