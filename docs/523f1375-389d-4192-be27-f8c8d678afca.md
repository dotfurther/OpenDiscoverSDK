# Identify Document File Formats

The Open Discover® SDK file format identifier API (see <a href="5c18f0cf-0ec5-aff9-10b8-e2c62ac74a73">DocumentIdentifier</a>) identifies over 1,500 file formats using internal signatures specific to the identified formats.

Overloaded method <a href="5c18f0cf-0ec5-aff9-10b8-e2c62ac74a73">DocumentIdentifier</a>.Identify is used to identify a document's file format. This method returns an <a href="b988a0c1-116e-339f-6db3-dfdf9ab0247a">IdResult</a> object that contains information on the identified file format (see <a href="6f1047fb-7367-c09c-5621-ae7632c8404b">Id</a>), known file extensions of the file format, description of the format, format classification (see <a href="1e3a8090-926a-275b-2e9c-c0851d3c49e2">IdClassification</a>), quality (confidence) of the identification (see <a href="c5bfb9da-8df4-6553-d5ca-622ad0412bda">IdMatchType</a>), and more.

The following unit test example illustrates how to use DocumentIdentifier.Identify method and also show cases most of the properties on the returned <a href="b988a0c1-116e-339f-6db3-dfdf9ab0247a">IdResult</a> object:


**File Format Identification**  
``` C#
var filePath = @"C:\WordProcessing\Word2003.doc";
using (var stream = File.OpenRead(filePath))
{
    var idResult = DocumentIdentifier.Identify(stream, filePath);
    Assert.IsTrue(idResult.ID             == Id.Word2003);
    Assert.IsTrue(idResult.Classification == IdClassification.WordProcessing);
    Assert.IsTrue(idResult.MatchType      == IdMatchType.SignatureAndExtension);
    Assert.IsTrue(idResult.IsEncrypted    == false);  
    Assert.IsTrue(idResult.MediaType      == "application/msword");  
    Assert.IsTrue(idResult.Description      != null);  
    Assert.IsTrue(idResult.PrimaryExtension != null);                  
    Assert.IsTrue(idResult.Extensions       != null);
}
```

In the above example, DocumentIdentifier.Identify returns an <a href="b988a0c1-116e-339f-6db3-dfdf9ab0247a">IdResult</a> object. The IdResult class contains useful information about the identified file format. If the document format cannot be identified then the IdResult.ID property will be set to <a href="6f1047fb-7367-c09c-5621-ae7632c8404b">Id</a>.Unknown.

For example C# application usage of the DocumentIdentifier class, see our Github repository: <a href="https://github.com/dotfurther/OpenDiscoverSDK/tree/master/SdkExamples/DocumentIdentifier" target="_blank" rel="noopener noreferrer">Open Discover® SDK DocumentIdentifier Example</a>





<table>
	<tr>
		<th>
			<img src="media/AlertNote.png" alt="Note">
				
			</img>  Note
		</th>
	</tr>
	<tr>
		
		<td>
		<p>Open Discover SDK file format identification does not rely on file extensions except to judge the quality of identification and to help identify a small number of <a href="6f1047fb-7367-c09c-5621-ae7632c8404b">Id</a>'s that do not have unique enough identifying signatures. One such case would be encrypted Microsoft Office 2007 (and newer) Word, PowerPoint, and Excel documents. In their password encrypted state, these documents have the exact same internal file format (OLE2 compound file format) that has an encrypted OLE stream that contains the original document. Without the file extension (.docx,.pptx,.xlsx) it is impossible to know which specific Office format the document is until after it is decrypted. If the extension is removed from an encrypted Office 2007 and newer document it will be identified as a generic Id.MicrosoftOfficeEncrypted for this reason.</p><p>

For the above reasons, it is recommended that the user always populate the <a href="5c18f0cf-0ec5-aff9-10b8-e2c62ac74a73">DocumentIdentifier</a>.Identify 'filePath' argument with the file's full path or file name with extension, if known.</p></td>
	</tr>
</table>




<table>
	<tr>
		<th>
			<img src="media/AlertNote.png" alt="Note">
				
			</img>  Note
		</th>
	</tr>
	<tr>
		
		<td>
		<p>The .NET assemblies that make up Open Discover SDK are x64 release builds (not AnyCPU) due to x64 dependencies. Therefore, applications that reference and use the SDK assemblies MUST also be x64 builds.</p></td>
	</tr>
</table>



## See Also


#### Reference
<a href="5c18f0cf-0ec5-aff9-10b8-e2c62ac74a73">DocumentIdentifier</a>  
<a href="b988a0c1-116e-339f-6db3-dfdf9ab0247a">IdResult</a>  
<a href="6f1047fb-7367-c09c-5621-ae7632c8404b">Id</a>  
<a href="c5bfb9da-8df4-6553-d5ca-622ad0412bda">IdMatchType</a>  
<a href="1e3a8090-926a-275b-2e9c-c0851d3c49e2">IdClassification</a>  


#### Other Resources
<a href="https://github.com/dotfurther/OpenDiscoverSDK" target="_blank" rel="noopener noreferrer">Open Discover® SDK for .NET Samples Repository on GitHub</a>  
